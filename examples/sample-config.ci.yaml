# net-net Configuration Example
# This file demonstrates all available configuration options

# Network Interface Configuration
interface:
    # Interface to capture from (e.g., en0, eth0, wlan0)
    # Use "any" to capture from all interfaces (Linux only)
    name: "lo0" # or "lo0" for localhost

    # Promiscuous mode: capture all packets on the network segment
    promiscuous: true

    # Snapshot length: maximum bytes to capture per packet
    # 65535 = full packet, smaller values = header only
    snaplen: 65535

    # Read timeout in milliseconds
    # How long to wait before processing buffered packets
    timeout_ms: 1000

    bpf_filter: ""

# Offline Capture Mode (optional)
# Uncomment to read from pcap file instead of live capture
# offline:
#   file: "/Users/guns4kids/Documents/vscode-projects/net-net/tests/fixtures/icmp_sample.pcap"

# BPF Filter (Berkeley Packet Filter)
# Syntax: https://www.tcpdump.org/manpages/pcap-filter.7.html
filter:
    # Example filters (uncomment one):

    # Capture only icmp traffic
    # bpf: "icmp"

    # Capture only TCP traffic
    # bpf: "tcp"

    # Capture HTTP traffic (ports 80 and 443)
    # bpf: "tcp port 80 or tcp port 443"

    # Capture traffic to/from specific IP
    # bpf: "host 192.168.1.1"
    # bpf_filter: "host 192.168.1.254"
    # Capture DNS queries
    # bpf: "udp port 53"

    # Capture all traffic except SSH
    # bpf: "not tcp port 22"

    # No filter (capture everything)
    # bpf_filter: ""

# Connection Tracking
tracking:
    # Idle timeout: remove connections inactive for this duration (seconds)
    idle_timeout: 300

    # Cleanup interval: how often to check for stale connections (seconds)
    cleanup_interval: 60

# Statistics Aggregation
stats:
    # Aggregation window in seconds
    window_size: 60

    # Keep history for this many windows
    history_depth: 24

# Persistence (optional)
database:
    # SQLite file path for historical data
    path: "/tmp/netnet.db"

    # Retention period in days
    retention_days: 7

# API/Daemon Configuration:
api:
    # Enable REST API
    enabled: true

    # Listen address
    bind: "127.0.0.1"

    # Port
    port: 8082

    # Authentication token (testing only, use a secure token in production)
    # token: "your-secret-token-here"
    token: "af9ff608895efc542d80b608a24c13d2"

# Logging
logging:
    # Log level: debug, info, warn, error
    level: debug
    # Log file path (empty = stdout only)
    file: ""
    # Include timestamps
    timestamps: true

# Security
privilege:
    drop: true
    user: "nobody"
    group: "nobody"

# User Credentials (DEVELOPMENT ONLY - passwords are plaintext)
# In production, store bcrypt-hashed passwords and load from secure secrets manager
# User Credentials
users:
    # List of valid username/password pairs for API access
    - username: "admin"
      password: "10000$133d6487d65d3e218173650ff5d6f962$7661cac9078ff1a92db656227bb2cad8fa15cf043672395c300ea3b0ee183836" # TODO: Replace with bcrypt hash in production
      plaintext: "adminpass" # For testing only
    - username: "user"
      password: "10000$5936ff5a2a291c5d49914404eebbf120a56f6ade9f79d6bd34e71b3dd32f4405" # TODO: Replace with bcrypt hash in production
      plaintext: "userpass" # For testing only

# Performance Tuning
performance:
    # Buffer size for packet capture (bytes)
    # Larger = fewer drops, more memory
    buffer_size: 2097152 # 2MB

    # Worker thread count for packet processing
    # 0 = auto-detect CPU count
    worker_threads: 0
