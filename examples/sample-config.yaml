# net-net Configuration Example
# This file demonstrates all available configuration options

# Network Interface Configuration
interface:
  # Interface to capture from (e.g., en0, eth0, wlan0)
  # Use "any" to capture from all interfaces (Linux only)
  name: "en0"
  
  # Promiscuous mode: capture all packets on the network segment
  promiscuous: true
  
  # Snapshot length: maximum bytes to capture per packet
  # 65535 = full packet, smaller values = header only
  snaplen: 65535
  
  # Read timeout in milliseconds
  # How long to wait before processing buffered packets
  timeout_ms: 1000

# Offline Capture Mode (optional)
# Uncomment to read from pcap file instead of live capture
offline:
  file: "tests/fixtures/icmp_sample.pcap"

# BPF Filter (Berkeley Packet Filter)
# Syntax: https://www.tcpdump.org/manpages/pcap-filter.7.html
filter:
  # Example filters (uncomment one):
  
  # Capture only TCP traffic
  # bpf: "tcp"
  
  # Capture HTTP traffic (ports 80 and 443)
  # bpf: "tcp port 80 or tcp port 443"
  
  # Capture traffic to/from specific IP
  # bpf: "host 192.168.1.1"
  
  # Capture DNS queries
  # bpf: "udp port 53"
  
  # Capture all traffic except SSH
  # bpf: "not tcp port 22"
  
  # No filter (capture everything)
  bpf: ""

# Connection Tracking
tracking:
  # Idle timeout: remove connections inactive for this duration (seconds)
  idle_timeout: 300
  
  # Cleanup interval: how often to check for stale connections (seconds)
  cleanup_interval: 60

# Statistics Aggregation
stats:
  # Aggregation window in seconds
  window_size: 60
  
  # Keep history for this many windows
  history_depth: 24

# Persistence (optional)
# database:
  # SQLite file path for historical data
  path: "netnet.db"
  
  # Retention period in days
  retention_days: 7

API/Daemon Configuration
api:
  # Enable REST API
  enabled: true
  
  # Listen address
  bind: "127.0.0.1"
  
  # Port
  port: 8080
  
  # Authentication token (optional)
  token: "your-secret-token-here"

# Logging
logging:
  # Log level: debug, info, warn, error
  level: "info"
  
  # Log file path (empty = stdout only)
  file: ""
  
  # Include timestamps
  timestamps: true

# Security
security:
  # Drop privileges after opening capture device
  # Requires starting as root
  drop_privileges: true
  
  # User to drop to (leave empty to use current user)
  run_as_user: ""
  
  # Group to drop to
  run_as_group: ""

# Performance Tuning
performance:
  # Buffer size for packet capture (bytes)
  # Larger = fewer drops, more memory
  buffer_size: 2097152  # 2MB
  
  # Worker thread count for packet processing
  0 = auto-detect CPU count
  worker_threads: 0